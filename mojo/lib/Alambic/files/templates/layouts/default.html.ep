<!DOCTYPE html>
  <!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title><%== app->al->instance_name() %></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/plugins/metisMenu/metisMenu.min.css" rel="stylesheet">
    <link href="/css/sb-admin-2.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/default.css">

   <!-- script src="https://cdn.plot.ly/plotly-latest.min.js"></script -->
  
  </head>
  <body>
    <div id="wrapper">
      <!-- Navigation -->
      <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/"><span class="fa fa-flask"></span> &nbsp; <%== app->al->instance_name() %> (v. <%= app->al->instance_version() || "No version" %>)</a>
        </div>

        <ul class="nav navbar-top-links navbar-right">
% my $user_id = session('session_user') || '';
% my $user = app->al->users->get_user($user_id);
% my $user_name = defined($user) ? $user->{'name'} : $user_id;
% if (defined($user)) { 
          <li><%= $user_name %> &nbsp; <i class="fa fa-user fa-fw fa-lg"></i></li>
          <li><a href="/logout"><i class="fa fa-sign-out fa-fw fa-lg"></i></a></li>
% } else {
          <li><a href="/login"><i class="fa fa-user fa-fw fa-lg"></i></a></li>
% }
        </ul>
% my $url;
% if ( $self->req->url =~ m!^/documentation/! ) {
%   $url = 'doc';
% } elsif ( $self->req->url =~ m!^/projects/! ) {
%   $url = 'projects';
% } else {
%   $url = 'projects';
% }
        <!-- /.navbar-header -->
        <div class="navbar-default sidebar" role="navigation">
          <div class="sidebar-nav navbar-collapse">
            <ul class="nav" id="side-menu">
              <li><a href="/"><i class="fa fa-home fa-fw" style="color: orange;"></i> Home</a></li>
% if (defined($user)) { 
              <li><a href="/user/<%= $user_id %>/profile"><i class="fa fa-home fa-fw" style="color: orange;"></i> My Alambic</a></li>
% }
              <li<%== $url =~ m!^doc! ? ' class="active"' : '' %>><a href=""><i class="fa fa-life-ring fa-fw" style="color: orange;"></i> Documentation<span class="fa arrow"></span></a>
                <ul class="nav nav-second-level<%= $self->req->url =~ m!^/documentation! ? ' active' : '' %>">
                  <li><a href="/documentation/main.html">Summary</a></li>
                  <li><a href="/documentation/data.html">Data</a></li>
                  <li><a href="/documentation/plugins.html">Plugins</a></li>
                  <li><a href="/documentation/metrics.html">Metrics</a></li>
                  <li><a href="/documentation/attributes.html">Attributes</a></li>
                  <li><a href="/documentation/quality_model.html">Quality Model</a></li>
                  <li><a href="/documentation/references.html">References</a></li>
              </ul></li>
              <li<%== $url =~ m!^projects! ? ' class="active"' : '' %>><a href=""><i class="fa fa-dashboard fa-fw" style="color: orange;"></i> Projects<span class="fa arrow"></span></a>
                <ul class="nav nav-second-level<%= $self->req->url =~ m!^/projects! ? ' active' : '' %>">
% my $projects = app->al->get_projects_list();
% my @projects = sort { $projects->{$a} cmp $projects->{$b} } keys %$projects;
% foreach my $project ( @projects ) {
%   my $proj_full = app->al->get_project($project);
%   next if (not $proj_full->active);
                  <li><a href="/projects/<%= $project %>.html"><%= $projects->{$project} %></a></li>
% }
              </ul></li>
              <li><a href="/admin/summary"><i class="fa fa-wrench fa-fw" style="color: orange;"></i> Admin panel</a></li>
              <li><a href="/about.html"><i class="fa fa-comment-o fa-fw" style="color: orange;"></i> About</a></li>
            </ul>
          </div>
        </div>
      </nav>
      
      <div id="page-wrapper">
        <div class="row">
          <div class="col-md-12">

            <%= content %>
    
            <hr />

            <p class="pull-right">Page generated by Alambic <%= app->al->instance_version() || "No version" %> on <%= localtime %>.</p>

          </div>
        </div>
      </div>
    </div>

    <!--[if lt IE 7]>
    <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
			     ga('create', '<%= app->al->get_repo_db->conf->{'google-tracking'} || '' %>', 'auto');
			     ga('send', 'pageview');

			     </script>

    <!-- jQuery -->
    <script src="/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="/js/plugins/metisMenu/metisMenu.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="/js/sb-admin-2.js"></script>

  </body>
</html>
